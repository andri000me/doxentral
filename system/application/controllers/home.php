<?phpclass Home extends Controller {	var $upload_path = '';	function Home()	{		parent::Controller();		$this->upload_path = $this->config->item('upload_path', 'settings');		$this->load->library('session');	}	function index($_type=NULL)	{		$_type = trim($_type);		$data['_type'] = $_type;		if( is_array($this->session->userdata('doxentral_SSO')) ) {			$data['user_data'] = $this->session->userdata('doxentral_SSO');			if( $_type == '' ) {				$this->load->view('header');				$this->load->view('navbar', $data);			}			if( $data['user_data']['user_type'] == 1 ) {				$this->load->model('FileModel');				$data['own_files'] = $this->FileModel->get_owned_files($data['user_data']['user_id'], $data['user_data']['user_type']);			} else {				$this->load->model('FileModel');				$data['own_files'] = $this->FileModel->get_owned_files($data['user_data']['user_id'], $data['user_data']['user_type']);				$data['assigned_files'] = $this->FileModel->get_assigned_files($data['user_data']['user_id']);			}			//$this->load->view('home_swf');			$this->load->view('home', $data);			if( $_type == '' )				$this->load->view('footer');		} else {			redirect('auth');		}	}	function upload()	{		log_message('debug', 'HERE: '.print_r($this->session->userdata('doxentral_SSO'), true));		if (isset($_FILES["resume_file"]) && is_uploaded_file($_FILES["resume_file"]["tmp_name"]) && $_FILES["resume_file"]["error"] == 0) {		$uploaddir = $this->upload_path;		$file_name= $_FILES['resume_file']['name'];		$file = $uploaddir . basename($_FILES['resume_file']['name']);		$path_parts = pathinfo($uploaddir . basename($_FILES['resume_file']['name']));		$extension=strtolower($path_parts['extension']);		$size=$_FILES['resume_file']['size'];			if( move_uploaded_file($_FILES['resume_file']['tmp_name'], $file) ) {				mt_srand();				$file_rename = md5(uniqid(mt_rand())).'.'.$extension;				$data = array(					'file_name' => $file_name,					'file_on_disk' => $file_rename,					'file_created' =>date('Y-m-d H-i-s')				);					$this->db->insert('files',$data);					echo $this->db->insert_id();				}		}	}	function thanks()	{		// Check for a degraded file upload, this means SWFUpload did not load and the user used the standard HTML upload		$used_degraded = false;		$resume_id = "";		if (isset($_FILES["resume_degraded"]) && is_uploaded_file($_FILES["resume_degraded"]["tmp_name"]) && $_FILES["resume_degraded"]["error"] == 0) {		$resume_id = $_FILES["resume_degraded"]["name"];		$used_degraded = true;		}		// Check for the file id we should have gotten from SWFUpload		if (isset($_POST["hidFileID"]) && $_POST["hidFileID"] != "" ) {			$resume_id = $_POST["hidFileID"];		}		if ($resume_id == "") {		        echo "<p>Your file was not uploaded.</p>";		} else {			$ses = $this->session->userdata('doxentral_SSO');			$data = array(					'file_owner' => $ses['user_id'],					'file_title' =>	htmlspecialchars($_POST["firstname"]),					'file_desc' =>	htmlspecialchars($_POST["education"]),					'file_status'=>	1					);			$this->db->where('file_id',$resume_id);			$this->db->update('files',$data);			redirect('home');		}	}}/* End of file welcome.php *//* Location: ./system/application/controllers/welcome.php */